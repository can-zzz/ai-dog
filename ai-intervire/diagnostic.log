[INFO] Scanning for projects...
[INFO] 
[INFO] ------------------------< com.can:ai-assistant >------------------------
[INFO] Building ai-assistant 0.0.1-SNAPSHOT
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] >>> spring-boot:3.2.3:run (default-cli) > test-compile @ ai-assistant >>>
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ ai-assistant ---
[INFO] Copying 1 resource from src/main/resources to target/classes
[INFO] Copying 4 resources from src/main/resources to target/classes
[INFO] 
[INFO] --- compiler:3.11.0:compile (default-compile) @ ai-assistant ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ ai-assistant ---
[INFO] skip non existing resourceDirectory /Users/can/Documents/ai/ai-intervire/src/test/resources
[INFO] 
[INFO] --- compiler:3.11.0:testCompile (default-testCompile) @ ai-assistant ---
[INFO] No sources to compile
[INFO] 
[INFO] <<< spring-boot:3.2.3:run (default-cli) < test-compile @ ai-assistant <<<
[INFO] 
[INFO] 
[INFO] --- spring-boot:3.2.3:run (default-cli) @ ai-assistant ---
[INFO] Attaching agents: []

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
[32m :: Spring Boot :: [39m              [2m (v3.2.3)[0;39m

16:22:47.708 [main] INFO  c.c.a.AiAssistantApplication - Starting AiAssistantApplication using Java 23.0.2 with PID 7675 (/Users/can/Documents/ai/ai-intervire/target/classes started by can in /Users/can/Documents/ai/ai-intervire)
16:22:47.709 [main] INFO  c.c.a.AiAssistantApplication - No active profile set, falling back to 1 default profile: "default"
16:22:48.059 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8081 (http)
16:22:48.064 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
16:22:48.064 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
16:22:48.085 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
16:22:48.085 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 357 ms
16:22:48.226 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page template: index
16:22:48.314 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8081 (http) with context path ''
16:22:48.318 [main] INFO  c.c.a.AiAssistantApplication - Started AiAssistantApplication in 0.914 seconds (process running for 1.048)
16:22:48.318 [main] INFO  c.c.a.AiAssistantApplication - ===========================================
16:22:48.318 [main] INFO  c.c.a.AiAssistantApplication - AI智能助手启动成功！
16:22:48.319 [main] INFO  c.c.a.AiAssistantApplication - 访问地址: http://localhost:8081
16:22:48.319 [main] INFO  c.c.a.AiAssistantApplication - 健康检查: http://localhost:8081/api/ai/health
16:22:48.319 [main] INFO  c.c.a.AiAssistantApplication - ===========================================
16:23:00.262 [http-nio-8081-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
16:23:00.263 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
16:23:00.263 [http-nio-8081-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
16:23:03.297 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:03.297 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - 会话ID: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.297 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - 用户消息: ser
16:23:03.297 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:03.297 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 路由: 标准对话, 耗时: 0ms
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.299 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 1ms
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 路由: 标准对话
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:03.300 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.300 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:03.300 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 模型: qwen-turbo, 消息数: 2
16:23:03.710 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 响应时间: 402ms, 状态码: 200
16:23:03.711 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 首块延迟: 403ms
16:23:05.470 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 总块数: 17
16:23:05.471 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 总耗时: 2171ms, 总块数: 17, 首块延迟: 403ms, 消息长度: 77字符
16:23:05.475 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 77, 内容: 你好！看起来你可能输入了“ser”，但不确定你的具体需求。请问你是想了解某个特定的术语、名字，还是有...
16:23:05.477 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 策略: 上下文感知生成, 耗时: 2177ms
16:23:05.478 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 2178ms
16:23:05.478 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:05.478 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:05.479 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 响应长度: 77, 内容: 你好！看起来你可能输入了“ser”，但不确定你的具体需求。请问你是想了解某个特定的术语、名字，还是有...
16:23:05.479 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 耗时: 1ms
16:23:05.479 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 1ms
16:23:05.479 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:05.480 [pool-2-thread-1] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e
16:23:05.481 [pool-2-thread-1] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 错误: ResponseBodyEmitter has already completed, 耗时: 1ms
16:23:05.482 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 3ms
16:23:05.482 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 总耗时: 2183ms
16:23:05.482 [http-nio-8081-exec-3] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: 48d6dbc0-e514-494b-aeaa-c48154dd029e, 总处理时长: 2185ms
16:23:05.483 [http-nio-8081-exec-3] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:23:13.519 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:13.519 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 会话ID: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.519 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 用户消息: reqr
16:23:13.519 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:13.519 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:13.519 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:13.519 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 路由: 标准对话, 耗时: 0ms
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 路由: 标准对话
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:13.520 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:13.520 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 模型: qwen-turbo, 消息数: 2
16:23:13.737 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 响应时间: 217ms, 状态码: 200
16:23:13.738 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 首块延迟: 218ms
16:23:15.159 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 总块数: 14
16:23:15.160 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 总耗时: 1640ms, 总块数: 14, 首块延迟: 218ms, 消息长度: 57字符
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 57, 内容: 看起来你可能输入有误，或者没有表达清楚你的问题。请重新描述一下你需要什么帮助或解答什么问题，我会尽力...
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 策略: 上下文感知生成, 耗时: 1641ms
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1641ms
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:15.161 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 响应长度: 57, 内容: 看起来你可能输入有误，或者没有表达清楚你的问题。请重新描述一下你需要什么帮助或解答什么问题，我会尽力...
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 耗时: 1ms
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 1ms
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333
16:23:15.162 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 总处理时长: 1643ms
16:23:15.162 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:23:15.162 [pool-2-thread-1] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 错误: ResponseBodyEmitter has already completed, 耗时: 0ms
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 0ms
16:23:15.162 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: 3ff1e38a-6767-4e79-b478-17eaf02da333, 总耗时: 1643ms
16:23:26.980 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:26.981 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 会话ID: diagnostic-test
16:23:26.981 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 用户消息: 测试消息
16:23:26.981 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:26.981 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:26.981 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:26.981 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:26.981 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:26.981 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: diagnostic-test, 路由: 标准对话, 耗时: 0ms
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 1ms
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: diagnostic-test, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: diagnostic-test, 路由: 标准对话
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:26.982 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: diagnostic-test
16:23:26.982 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: diagnostic-test, 模型: qwen-turbo, 消息数: 2
16:23:27.193 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: diagnostic-test, 响应时间: 210ms, 状态码: 200
16:23:27.193 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: diagnostic-test, 首块延迟: 210ms
16:23:27.638 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:27.638 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 会话ID: diagnostic-test
16:23:27.639 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 用户消息: 测试消息
16:23:27.639 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:27.639 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: diagnostic-test, 路由: 标准对话, 耗时: 0ms
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: diagnostic-test, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: diagnostic-test, 路由: 标准对话
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:27.639 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: diagnostic-test
16:23:27.639 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: diagnostic-test, 模型: qwen-turbo, 消息数: 2
16:23:27.846 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: diagnostic-test, 响应时间: 206ms, 状态码: 200
16:23:27.846 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: diagnostic-test, 首块延迟: 206ms
16:23:28.287 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: diagnostic-test, 总块数: 11
16:23:28.287 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: diagnostic-test, 总耗时: 1305ms, 总块数: 11, 首块延迟: 210ms, 消息长度: 33字符
16:23:28.288 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 33, 内容: 你好！这是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:23:28.289 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: diagnostic-test, 策略: 上下文感知生成, 耗时: 1307ms
16:23:28.289 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1307ms
16:23:28.289 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: diagnostic-test
16:23:28.289 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: diagnostic-test
16:23:28.289 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: diagnostic-test, 响应长度: 33, 内容: 你好！这是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: diagnostic-test, 耗时: 1ms
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 1ms
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: diagnostic-test
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: diagnostic-test
16:23:28.290 [pool-2-thread-1] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: diagnostic-test, 错误: ResponseBodyEmitter has already completed, 耗时: 0ms
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 0ms
16:23:28.290 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: diagnostic-test, 总耗时: 1309ms
16:23:28.290 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: diagnostic-test, 总处理时长: 1310ms
16:23:28.290 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:23:28.831 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: diagnostic-test, 总块数: 10
16:23:28.831 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: diagnostic-test, 总耗时: 1192ms, 总块数: 10, 首块延迟: 206ms, 消息长度: 31字符
16:23:28.832 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 31, 内容: 你好！这是测试消息，如果你有任何问题或需要帮助，请随时告诉我。...
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: diagnostic-test, 策略: 上下文感知生成, 耗时: 1194ms
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1194ms
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: diagnostic-test
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: diagnostic-test
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: diagnostic-test, 响应长度: 31, 内容: 你好！这是测试消息，如果你有任何问题或需要帮助，请随时告诉我。...
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: diagnostic-test, 耗时: 0ms
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 0ms
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: diagnostic-test
16:23:28.833 [pool-2-thread-2] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: diagnostic-test
16:23:28.834 [pool-2-thread-2] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: diagnostic-test, 错误: ResponseBodyEmitter has already completed, 耗时: 1ms
16:23:28.834 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 1ms
16:23:28.834 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: diagnostic-test, 总耗时: 1195ms
16:23:28.834 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: diagnostic-test, 总处理时长: 1196ms
16:23:28.834 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:23:29.929 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:29.929 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - 会话ID: diagnostic-test
16:23:29.929 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - 用户消息: 测试消息
16:23:29.929 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:29.929 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:29.930 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: diagnostic-test, 路由: 标准对话, 耗时: 0ms
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: diagnostic-test
16:23:29.931 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: diagnostic-test
16:23:29.937 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: diagnostic-test, 历史记录: 4, 压缩后: 4, 耗时: 6ms
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 7ms
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: diagnostic-test
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: diagnostic-test, 路由: 标准对话
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: diagnostic-test
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🔍 添加历史上下文 - 会话: diagnostic-test, 压缩后消息数: 4
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:23:29.938 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是测试消息，如果你有任何问题或需要帮助，请随时告诉我。...
16:23:29.938 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: diagnostic-test
16:23:29.938 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: diagnostic-test, 模型: qwen-turbo, 消息数: 6
16:23:30.160 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: diagnostic-test, 响应时间: 221ms, 状态码: 200
16:23:30.160 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: diagnostic-test, 首块延迟: 221ms
16:23:31.256 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: diagnostic-test, 总块数: 11
16:23:31.257 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: diagnostic-test, 总耗时: 1319ms, 总块数: 11, 首块延迟: 221ms, 消息长度: 34字符
16:23:31.257 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 34, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: diagnostic-test, 策略: 上下文感知生成, 耗时: 1320ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1320ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: diagnostic-test
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: diagnostic-test
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: diagnostic-test, 响应长度: 34, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: diagnostic-test, 耗时: 0ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 0ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: diagnostic-test
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: diagnostic-test
16:23:31.258 [pool-2-thread-2] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: diagnostic-test, 错误: ResponseBodyEmitter has already completed, 耗时: 0ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 0ms
16:23:31.258 [http-nio-8081-exec-1] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: diagnostic-test, 总处理时长: 1329ms
16:23:31.258 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: diagnostic-test, 总耗时: 1328ms
16:23:31.258 [http-nio-8081-exec-1] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:23:41.702 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:23:41.703 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - 会话ID: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.703 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - 用户消息: erqwer
16:23:41.703 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - 深度思考: false
16:23:41.703 [http-nio-8081-exec-6] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:23:41.703 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:23:41.703 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 路由: 标准对话, 耗时: 0ms
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 路由: 标准对话
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:23:41.704 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.705 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:41.705 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 模型: qwen-turbo, 消息数: 2
16:23:41.968 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 响应时间: 263ms, 状态码: 200
16:23:41.969 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 首块延迟: 264ms
16:23:43.291 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 总块数: 13
16:23:43.291 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 总耗时: 1586ms, 总块数: 13, 首块延迟: 264ms, 消息长度: 53字符
16:23:43.293 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 53, 内容: 看起来你可能输入了错误的内容或者测试我的反应。如果你有任何问题或需要帮助，请告诉我，我会尽力为你提供...
16:23:43.293 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 策略: 上下文感知生成, 耗时: 1589ms
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1590ms
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 响应长度: 53, 内容: 看起来你可能输入了错误的内容或者测试我的反应。如果你有任何问题或需要帮助，请告诉我，我会尽力为你提供...
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 耗时: 0ms
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 0ms
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:43.294 [pool-2-thread-2] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2
16:23:43.295 [pool-2-thread-2] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 错误: ResponseBodyEmitter has already completed, 耗时: 1ms
16:23:43.295 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 1ms
16:23:43.295 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 总处理时长: 1593ms
16:23:43.295 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: 5b20c646-79dd-4231-b888-d5b382b8a7b2, 总耗时: 1592ms
16:23:43.295 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:24:06.146 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:24:06.147 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 会话ID: diagnostic-test
16:24:06.147 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 用户消息: 测试消息
16:24:06.147 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 深度思考: false
16:24:06.147 [http-nio-8081-exec-4] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:24:06.147 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:24:06.147 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:24:06.147 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: diagnostic-test, 路由: 标准对话, 耗时: 1ms
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 1ms
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: diagnostic-test
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: diagnostic-test
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: diagnostic-test, 历史记录: 6, 压缩后: 6, 耗时: 0ms
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: diagnostic-test
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: diagnostic-test, 路由: 标准对话
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: diagnostic-test
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:24:06.148 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 🔍 添加历史上下文 - 会话: diagnostic-test, 压缩后消息数: 6
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是测试消息，如果你有任何问题或需要帮助，请随时告诉我。...
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.149 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:06.149 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: diagnostic-test
16:24:06.149 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: diagnostic-test, 模型: qwen-turbo, 消息数: 8
16:24:06.333 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: diagnostic-test, 响应时间: 183ms, 状态码: 200
16:24:06.334 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: diagnostic-test, 首块延迟: 184ms
16:24:06.631 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:24:06.631 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 会话ID: diagnostic-test
16:24:06.631 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 用户消息: 测试消息
16:24:06.631 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 深度思考: false
16:24:06.631 [http-nio-8081-exec-5] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: diagnostic-test, 路由: 标准对话, 耗时: 0ms
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: diagnostic-test
16:24:06.631 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: diagnostic-test
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: diagnostic-test, 历史记录: 6, 压缩后: 6, 耗时: 1ms
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 1ms
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: diagnostic-test
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: diagnostic-test, 路由: 标准对话
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: diagnostic-test
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🔍 添加历史上下文 - 会话: diagnostic-test, 压缩后消息数: 6
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这是测试消息，如果你有任何问题或需要帮助，请随时告诉我。...
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: user, 内容: 测试消息...
16:24:06.632 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 历史消息 - 角色: assistant, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:06.632 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: diagnostic-test
16:24:06.632 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: diagnostic-test, 模型: qwen-turbo, 消息数: 8
16:24:06.860 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: diagnostic-test, 响应时间: 227ms, 状态码: 200
16:24:06.862 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: diagnostic-test, 首块延迟: 229ms
16:24:07.417 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: diagnostic-test, 总块数: 11
16:24:07.418 [pool-2-thread-2] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: diagnostic-test, 总耗时: 1268ms, 总块数: 11, 首块延迟: 184ms, 消息长度: 34字符
16:24:07.419 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 34, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:07.419 [pool-2-thread-2] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: diagnostic-test, 策略: 上下文感知生成, 耗时: 1271ms
16:24:07.419 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1271ms
16:24:07.419 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: diagnostic-test
16:24:07.419 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: diagnostic-test
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: diagnostic-test, 响应长度: 34, 内容: 你好！这又是一条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: diagnostic-test, 耗时: 1ms
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 1ms
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: diagnostic-test
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: diagnostic-test
16:24:07.420 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: diagnostic-test, 总处理时长: 1274ms
16:24:07.420 [pool-2-thread-2] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: diagnostic-test, 错误: ResponseBodyEmitter has already completed, 耗时: 0ms
16:24:07.420 [http-nio-8081-exec-7] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 0ms
16:24:07.420 [pool-2-thread-2] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: diagnostic-test, 总耗时: 1273ms
16:24:07.934 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: diagnostic-test, 总块数: 11
16:24:07.934 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: diagnostic-test, 总耗时: 1302ms, 总块数: 11, 首块延迟: 229ms, 消息长度: 34字符
16:24:07.935 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 34, 内容: 你好！这是第4条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: diagnostic-test, 策略: 上下文感知生成, 耗时: 1304ms
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1304ms
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: diagnostic-test
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: diagnostic-test
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: diagnostic-test, 响应长度: 34, 内容: 你好！这是第4条测试消息。如果你有任何问题或需要帮助，请随时告诉我！...
16:24:07.936 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: diagnostic-test, 耗时: 0ms
16:24:07.937 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 1ms
16:24:07.937 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: diagnostic-test
16:24:07.937 [pool-2-thread-1] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: diagnostic-test
16:24:07.937 [pool-2-thread-1] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: diagnostic-test, 错误: ResponseBodyEmitter has already completed, 耗时: 0ms
16:24:07.937 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 0ms
16:24:07.937 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: diagnostic-test, 总耗时: 1306ms
16:24:07.938 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: diagnostic-test, 总处理时长: 1307ms
16:24:07.938 [http-nio-8081-exec-8] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
16:24:13.062 [http-nio-8081-exec-1] ERROR c.c.a.e.GlobalExceptionHandler - Unexpected exception occurred: No static resource .well-known/appspecific/com.chrome.devtools.json.
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .well-known/appspecific/com.chrome.devtools.json.
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1575)
16:24:15.165 [http-nio-8081-exec-10] INFO  c.c.a.controller.StreamController - === 流式聊天请求开始 ===
16:24:15.165 [http-nio-8081-exec-10] INFO  c.c.a.controller.StreamController - 会话ID: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.165 [http-nio-8081-exec-10] INFO  c.c.a.controller.StreamController - 用户消息: rqwerq
16:24:15.165 [http-nio-8081-exec-10] INFO  c.c.a.controller.StreamController - 深度思考: false
16:24:15.165 [http-nio-8081-exec-10] INFO  c.c.a.controller.StreamController - 超时配置: 300000ms
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🤖 智能体执行开始
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📋 执行预处理阶段
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - 🔄 开始预处理请求
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.RequestPreprocessor - ✅ 请求预处理完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 路由: 标准对话, 耗时: 0ms
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 预处理完成 - 路由: 标准对话, 耗时: 0ms
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🧠 执行内存加载阶段 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 🧠 加载上下文 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文加载完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 历史记录: 0, 压缩后: 0, 耗时: 0ms
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存加载完成 - 耗时: 0ms
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 📝 执行响应生成阶段 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 📝 响应生成开始 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 路由: 标准对话
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🎯 生成策略: 上下文感知生成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - 🧠 执行上下文感知生成
16:24:15.165 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ⚠️ 没有历史上下文 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.166 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🔍 开始验证流式调用参数 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:15.166 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 📡 开始流式AI模型调用 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 模型: qwen-turbo, 消息数: 2
16:24:15.449 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🌐 HTTP响应已接收 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 响应时间: 283ms, 状态码: 200
16:24:15.450 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ⚡ 首个数据块已接收 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 首块延迟: 284ms
16:24:16.755 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - 🏁 流式响应结束标记 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 总块数: 13
16:24:16.755 [pool-2-thread-1] INFO  c.can.aiassistant.service.AiService - ✅ 流式响应处理完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 总耗时: 1589ms, 总块数: 13, 首块延迟: 284ms, 消息长度: 53字符
16:24:16.757 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ ResponseCollector保存最终响应 - 长度: 53, 内容: 看起来你可能输入了一些无意义的字符或者打错了。如果你有任何问题或需要帮助，请告诉我，我会尽力为你提供...
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.ResponseGenerator - ✅ 响应生成完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 策略: 上下文感知生成, 耗时: 1593ms
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 响应生成完成 - 耗时: 1593ms
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 💾 执行内存保存阶段 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存上下文 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - 💾 保存AI响应 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 响应长度: 53, 内容: 看起来你可能输入了一些无意义的字符或者打错了。如果你有任何问题或需要帮助，请告诉我，我会尽力为你提供...
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.MemoryManager - ✅ 上下文保存完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 耗时: 0ms
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 内存保存完成 - 耗时: 0ms
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🔄 执行后处理阶段 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:16.758 [pool-2-thread-1] INFO  c.c.a.service.PostProcessor - 🔄 后处理开始 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9
16:24:16.759 [pool-2-thread-1] ERROR c.c.a.service.PostProcessor - ❌ 后处理失败 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 错误: ResponseBodyEmitter has already completed, 耗时: 1ms
16:24:16.759 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - ✅ 后处理完成 - 耗时: 1ms
16:24:16.759 [pool-2-thread-1] INFO  c.c.a.service.AgentExecutor - 🎉 智能体执行完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 总耗时: 1594ms
16:24:16.760 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - ✅ 流式聊天完成 - 会话: d320cfb6-d808-4951-af0c-48d01d5f14d9, 总处理时长: 1595ms
16:24:16.760 [http-nio-8081-exec-2] INFO  c.c.a.controller.StreamController - === 流式聊天请求结束 ===
